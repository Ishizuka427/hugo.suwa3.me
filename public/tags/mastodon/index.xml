<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>mastodon on suwa3 blog</title>
    <link>https://hugo.suwa3.me/tags/mastodon/</link>
    <description>Recent content in mastodon on suwa3 blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-JP</language>
    <lastBuildDate>Sat, 14 Mar 2020 13:00:00 +0000</lastBuildDate><atom:link href="https://hugo.suwa3.me/tags/mastodon/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>まともに起動</title>
      <link>https://hugo.suwa3.me/post/2020-03-14-%E3%81%BE%E3%81%A8%E3%82%82%E3%81%AB%E8%B5%B7%E5%8B%95/</link>
      <pubDate>Sat, 14 Mar 2020 13:00:00 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2020-03-14-%E3%81%BE%E3%81%A8%E3%82%82%E3%81%AB%E8%B5%B7%E5%8B%95/</guid>
      <description>ようやく、まともにマストドンを起動して動かすことができたので
作業ログをここに残します。
感動を通り越して若干うんざりです😢
経緯 EC2上にdocker-compose で SNS の運用をしていましたが、CPU使用率が100％のまま下がらない状態が続いているため EC2 のローカルへ移行することにしました。 まずは CPU をなんとかする。
条件 データは死守する 移行対象は docker-compose on EC2 (まともに ssh ログインできない) アプリケーションのバージョン追従はしていない。 t2.micro 縛り(可能な限り) 今後のTODO 現状の設定ファイルは Docker 用のためEC2用に全部書き直し 最終的に DB のバージョンを変更する必要あり 懸念点 dump データが途中から明らかに容量が小さい。データ壊れている疑惑あり。 など、諸々の問題を抱えながらも一つ一つ潰して、構築を済ませることができました！とても勉強になりました。
以下、CPU をなんとかした作業ログです。
swapの設定 まず、swapの設定をしました。
以前やったことがあったので その時のblog を参考に、そのままコピペでいけました。
Docker上の不要なファイルをローカルに移動 ubuntu ユーザーの ~/ 直下に dump を移動 ファイルの権限変える chmod scp -i ~/.ssh/**.pem *****@3.***.6.***:/home/ubuntu/dump-latest.sql.gz /Users/a_ishizuka/tmp/ ■ CPUQuota の設定 CPU の張り付きを防ぐために、CPUQuota の設定をして CPU 使用率の制限を行いました。
コントロールグループの変更 Red Hat Enterprise Linux 7 | Red Hat Customer Portal</description>
    </item>
    
    <item>
      <title>作業ログ</title>
      <link>https://hugo.suwa3.me/post/2020-02-22-%E4%BD%9C%E6%A5%AD%E3%83%AD%E3%82%B0/</link>
      <pubDate>Sat, 22 Feb 2020 13:00:00 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2020-02-22-%E4%BD%9C%E6%A5%AD%E3%83%AD%E3%82%B0/</guid>
      <description>今日から素直で可愛げのある駆け出しのインフラエンジニアになる。
なので、sshログイン後きちんとscreenでセッションを保存してから作業を始める。
https://qiita.com/hnishi/items/3190f2901f88e2594a5f
$ screen まず前回やった作業の記憶を呼び覚ますために
ユーザーを切り替えてhistory見つつ何をするか思い出す。
$ sudo su - $ sudo su mastodon $ cd /home/mastodon/live/ アセットコンパイルからだった。
$ RAILS_ENV=production bundle exec rails assets:precompile yarn install v1.21.1 [1/6] Validating package.json… [2/6] Resolving packages… [3/6] Fetching packages… CPUが張り付きました。
メモリ使用量を見ようにも
$ free コマンドが打てない。
無料枠で何とかしたいので
t2.microで出来るだけやってみる😢
OSSで詰んだらソースを読むタイムだよ。
ファイルやディレクトリ総当りをしながら
それっぽいものを探す作業です。jsに発狂してきたら水を飲んで落ち着こう。
https://github.com/tootsuite/mastodon/blob/master/config/webpack/configuration.js
↑最後の方にoutputという単語を見つけた。
逆算してpublic_output_path =&amp;gt; webpacker.ymlの行方を追います。
public配下のpacksっぽいことが判明した。
打開策としてDocker内の
/opt/mastodon/public/packs
をボリュームマウントしてホストに移動させて
そのまま圧縮してEC2に送る作戦でいきます。
**ローカルで作業
**イメージをDockerHubで見つけてきたのでpull
$ docker pull tootsuite/mastodon:v2.9.3 $ docker images REPOSITORY TAG IMAGE ID CREATED SIZE tootsuite/mastodon v2.</description>
    </item>
    
    <item>
      <title>マストドン構築 2日目</title>
      <link>https://hugo.suwa3.me/post/2020-01-16-%E3%83%9E%E3%82%B9%E3%83%88%E3%83%89%E3%83%B3%E6%A7%8B%E7%AF%89-2%E6%97%A5%E7%9B%AE/</link>
      <pubDate>Thu, 16 Jan 2020 13:00:00 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2020-01-16-%E3%83%9E%E3%82%B9%E3%83%88%E3%83%89%E3%83%B3%E6%A7%8B%E7%AF%89-2%E6%97%A5%E7%9B%AE/</guid>
      <description>サッと終わらせるはずが
まさかのマストドン9.2.3はRubyバージョン2.6.1でしか動かないらしく
Rubyのバージョン指定して入れ直しをしていたら時間かかりました😢
設定ファイルの編集まで終わりました。
メールサーバーのパスワード間違えたので
あとで.env.production の編集します。
あとはCSS/JSのコンパイルで時間がかかりすぎて途中でコケてしまったので
assets:precompileから指定して再開しました。
まとめたQiita記事がこちらです。
マストドン構築2日目 on AWS
本当はメールサーバーの設定も詳細記述できれば良かったのですが
SESの申請から解説するのは流石にしんどかったので
mailgunの宣伝だけしました！</description>
    </item>
    
    <item>
      <title>マストドン構築1日目</title>
      <link>https://hugo.suwa3.me/post/2020-01-13-%E3%83%9E%E3%82%B9%E3%83%88%E3%83%89%E3%83%B3%E6%A7%8B%E7%AF%891%E6%97%A5%E7%9B%AE/</link>
      <pubDate>Mon, 13 Jan 2020 13:00:00 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2020-01-13-%E3%83%9E%E3%82%B9%E3%83%88%E3%83%89%E3%83%B3%E6%A7%8B%E7%AF%891%E6%97%A5%E7%9B%AE/</guid>
      <description>本当はWordPressに書くつもりだったんだけれども。
Qiitaにフライングしました。。
マストドン構築1日目 on AWS
Markdownで書き始めたらWordPressに書くの面倒くさくなってしまった。
構築をしていて、Ubuntu上にPostgreSQL-9.6のバージョンを指定して入れようとしたら失敗したの。
マストドンの構築ドキュメントをザッと読み直したけれども
特に何も書かれていなくて
そういった場合は、入れるもの(今回であればUbuntuではなくPostgreSQL)の公式リファレンスを調べるのが近道だと学びました。
だいたい素の状態に入れる内容であれば
「この場合はこうしてね」
といった注意事項が書かれているのだなぁと思った。
errorや予想外の事態に沢山遭遇して
「こういった場合はここに情報があるんだな」
といった経験値を沢山積みたい。
問題解決能力の高いエンジニアになりたいです。</description>
    </item>
    
    <item>
      <title>Mastodon</title>
      <link>https://hugo.suwa3.me/post/2020-01-10-mastodon/</link>
      <pubDate>Fri, 10 Jan 2020 13:00:00 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2020-01-10-mastodon/</guid>
      <description>現状について整理してまとめたいと思います。
Mastodonとは まず、タイトルにあるMastodonですが
ドイツのプログラマーであるオイゲン氏が開発した、オープンソースの分散型SNSです。
Twitterライクな使い心地で
カラム表示に慣れれば、使い勝手はTwitterとあまり変わりません。
主だった違いとしては
まずオープンソースのため、GitHub上でソースコードが公開されており
誰でも構築・運用することが可能です。
また分散型であるため、それぞれのインスタンスで連携することが出来ます。
元々わたしはMastodonのユーザー側で
今はなきknzk.meをはじめとして、ポケマス、ドン・ゴロツキやjp、板橋丼など
様々なインスタンスに登録して、趣味コミュニティへの参加や
デザイン、機能などの違いを楽しむのが好きでした。
Mastodonについて、雰囲気をよく表現しているなぁ
と、感じた文章を見つけたので引用します。
https://twitter.com/noellabo/status/1076263455324160000?s=20
愛着のあったインスタンス閉鎖をきっかけに
自立したインスタンス運営をしたいと感じて
自力での構築、運用に挑戦したのが始まりです。
現状での構成 / 今後について 現状での構成が以下になります。
Webサービス (SNS) 構成
- EC2
- Nginx
- Docker compose
- detabase (Postgres)
- KVS (Redis)
- job queue (Side kiq)
- Websocket api
- webapplication (Ruby on rails)
- S3
- SES
- Route53
半年間、Docker上で本番運用しましたが
頻繁に不安定な状態になるため
Dockerから降ろして運用することにしました。
流れとしてはEC2インスタンスでサーバーを用意して
一からMastodonを構築し
動くことが確認出来次第、DBのリストアを行います。
構築について、主に参考にするのはGitHubリポジトリとhttps://github.com/tootsuite/mastodon
公式ドキュメントです
https://docs.joinmastodon.org/admin/prerequisites/
数年前であれば、Mastodon構築方法の記事は結構充実していたのですが
現在は見つけることが難しく、またバージョンも3系に上がったため</description>
    </item>
    
    <item>
      <title>ポート番号の変更</title>
      <link>https://hugo.suwa3.me/post/2019-09-21-%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7%E3%81%AE%E5%A4%89%E6%9B%B4/</link>
      <pubDate>Sat, 21 Sep 2019 13:00:00 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-09-21-%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7%E3%81%AE%E5%A4%89%E6%9B%B4/</guid>
      <description>もくもく会に参加してきました。
ProLabo渋谷もくもく会
黙々と作業しました！
ポート番号を変えるだけで攻撃数が激減するらしいという噂をきいて
早速試してみた。
まずログファイルからアクセス数を確認します。
$ cat /var/log/auth.log | grep -v sximada | grep -v ubuntu | grep -v CRON | grep -v &amp;lsquo;Sep 20&amp;rsquo; | wc -l
626件でした。
1日に600件以上のピンポンダッシュ&amp;hellip;&amp;hellip;恐怖でしかないです。
SSHログインのポート番号の設定を変える前に
万が一ログインができなくなった場合に備えて
（クラウドでSSHログインができなくなったら致命的なので）
スナップショットを撮っておきます。
AWSのEC2インスタンスのステータスをStoppingにしました。
なんと鯖立て初のStoppingです。
怒られてしまうかもしれない。
EC2の再起動をかけたら、立ち上がりにかなり時間がかかって
冷や汗もんでした😢
こわー！
無事EC2インスタンスが立ち上がり
/etc/ssh/sshd_config
こちらのファイルに
Port 22 Port 2222
と書いて
Port22はデフォルトの設定でコメントアウトしてあったのですが
なにも記述がなければ
22が自動的にSSH用の番号として割り振られるようです。
念のため22も残して2222からログインできるかテスト。
設定を適用させるため忘れずssh再起動です。
$ sudo service ssh restart
2222ポートからsshログインできるか確認。
$ ssh don.suwa3.me -p2222
ログインできました！
やったねえ
EC2インスタンスのセキュリティグループも変更しました。
忘れず変更したのえらーい、わーい
図でまとめておきました。
セキュリティグループのほうは</description>
    </item>
    
    <item>
      <title>v2.9.2 =&gt; v2.9.3</title>
      <link>https://hugo.suwa3.me/post/2019-08-12-v2-9-2-v2-9-3/</link>
      <pubDate>Mon, 12 Aug 2019 13:00:43 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-08-12-v2-9-2-v2-9-3/</guid>
      <description>午前中はお部屋の片付けをしていたの。
お昼過ぎに渋谷へ行って
Fab Cafeで作業をしたよ。
どんすわ無事にアップデートしました。
ターミナルのhistoryをまとめて
Evernoteにメモしました。
差分をきちんと確認して
それに合わせてアプデしないといけないのねえ。
git diffコマンド
便利なので覚えよう。
.
Illustratorで
スマホページの画像と
SNSのトップページの素材をつくっていたの。
Illustratorもっと使いこなせるようになりたいなあ。
夕方は山ちゃんに寄ってビール飲んだよ。
昭和の歌謡曲すきだなあとおもった。</description>
    </item>
    
    <item>
      <title>nail/Lodge</title>
      <link>https://hugo.suwa3.me/post/2019-07-27-nail-lodge/</link>
      <pubDate>Sat, 27 Jul 2019 13:00:28 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-27-nail-lodge/</guid>
      <description>久しぶりのネイルいってきました。
グレージュにしたの、くすんだピンクぽくて気に入った。
.
ネイルのあとはそのままYahoo!のLodgeへ直行した。
.
Kubernetesの予習をしていて
https://kubernetes.io/blog/2019/07/23/get-started-with-kubernetes-using-python/
.
PythonをつかってKubernetesをやってみようのページを試していました。
.
途中で低気圧のせいか頭痛がして
お薬を買いに行く途中吐き続けて、意識朦朧としてきたので帰宅したよ。
.
低気圧で具合が悪くなり過ぎるので
先日病院でいろいろと検査をして頂いて
｢問題ないです｣
と言われたばかりなのだけれども
台風の前や弾丸低気圧あると体調つらいなあ。
.
夜には少し体調が回復したので
Mastodonのユーザー開放で
登録してくれた方々の承認をしました。
脱おひとり様した。
保全を最優先してがんばるぞ。
.
EC2上にどんすわのDocker上にあるものを
そのまま直置きでサブ鯖立てよかなとおもっていたけれども
せっかくKubernetesの予習しているなら
クーバでクラスタ組む練習やってみたいなあとおもいました。</description>
    </item>
    
    <item>
      <title>どんすわ復活/postgreSQL</title>
      <link>https://hugo.suwa3.me/post/2019-07-26-%E3%81%A9%E3%82%93%E3%81%99%E3%82%8F%E5%BE%A9%E6%B4%BB-postgresql/</link>
      <pubDate>Fri, 26 Jul 2019 13:00:19 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-26-%E3%81%A9%E3%82%93%E3%81%99%E3%82%8F%E5%BE%A9%E6%B4%BB-postgresql/</guid>
      <description>どんすわピンチでメンテナンスページにしていたの。
とりあえずデータ保全を最優先してから
docker-compose restartしてみた。
Dockerのstatusを見てみたけれども
unhealthyから、なかなかhealthyにならず不安定な状態が続いて
泣く泣く師匠に相談したら
DockerのIDが何故か重複しているとのこと。
普通なら同じIDが二つ立ち上がる状況なさそうだけれども
重すぎてそういった状態になったのかなあってかんじ。
.
なので重複したものを一つ削除して
docker-composeのdownとupしたら
時間をおいて正常化したので
どんすわメンテナンス終了しました。
.
今回、何がうまくいっていないのか
まではわかったけれども
その原因まではわからなかったし
.
少し問題がややこしくなるとやっぱりわからないなあ。
冷静に素早く対処できる最強のエンジニアになりたいです。
.
あと、PCが触れない移動時間には
postgreSQLについて動画をみた。
見た内容まとめ。
データベース楽しい、また復習したい。
使いこなせたら万能感すごそう。
なんでも出来てしまう感じする。
.
データはとても大切で
データが吹っ飛ぶと会社が吹っ飛ぶレベルの事故に繋がるし
もし何かあったときには
データの保全を最優先に動くことを意識していくと良い
とアドバイスされた。
.
そしてデータベースにおける
本当にあった怖い話を聞いたの。
ヒヤリハットから、やらかしまで
怖い話こわかった。</description>
    </item>
    
    <item>
      <title>どんすわピンチ</title>
      <link>https://hugo.suwa3.me/post/2019-07-25-%E3%81%A9%E3%82%93%E3%81%99%E3%82%8F%E3%83%94%E3%83%B3%E3%83%81/</link>
      <pubDate>Thu, 25 Jul 2019 13:00:35 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-25-%E3%81%A9%E3%82%93%E3%81%99%E3%82%8F%E3%83%94%E3%83%B3%E3%83%81/</guid>
      <description>どんすわがとっても重くて
構築後はじめてのトラブルだよ。
わーわー‪\( ˙꒳˙ \三/ ˙꒳˙)/‬
.
朝から焦ってしまった。
.
お昼も焦っていた。
.
夕方あたりから
｢焦ってもしかたないな｣
ってマインドになったあ。
.
AWS開いてEC2見たり
アタックされていないことを確認したり
Dockerのコマンド触ってみたりして
Docker動かないなーってことで
データのバックアップをとってDocker再起動させる作戦にしました。
なんだか1日おつかれさまだったよ。
.
トラブルは意図的に起こすこと難しくて
責任を負わなくて良い環境で、こういったトラブルが起きたのは幸運なので
対処がんばってみよう
と、師匠にアドバイスされた。
.
どうせ利用者一人のSNSなので、データ飛ぶの覚悟で再起動かけても良かったのだけれども
もしユーザー登録開放したときには、そうも言っていられないし
ソロ防災訓練のつもりで対処方法を調べるのがんばりました。
.
とりあえず落ち着いて
ひとつひとつ手を動かして
どこまで動くのか確認するの大切なんだなあとおもった。</description>
    </item>
    
    <item>
      <title>ListとSESとメモ帳難民</title>
      <link>https://hugo.suwa3.me/post/2019-07-23-%E3%83%AA%E3%82%B9%E3%83%88/</link>
      <pubDate>Tue, 23 Jul 2019 13:00:39 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-23-%E3%83%AA%E3%82%B9%E3%83%88/</guid>
      <description>やること増えてきたので
まとめたのがこちらです。
issueと書かれたものはGitHubでissue管理されているもの。
最優先は就活と、期限の決まっているKubernetesかなあ。
.
Kubernetesは勉強会@女子部に登録したので
その予習をできるだけやっていきたい。
.
最近気づいたのは、入門系の講習やセミナーに
本気で予習無しや前提知識ゼロでいくと
ただただ｢訳分からん｣な時間を過ごす羽目になるので
できる限りじぶんで予習しておくべきだなとおもった。
入門系の勉強会はむしろ復習なのね。
.
最優先の就活だけれども、焦りたくはないの。
きちんと何がしたいのか見極めたいし
特に急いでいないので慎重に進められたら良いなあとおもいます。
.
AWSサポートにSESの送信制限解除の申請をした。
この申請が通れば、don.suwa3.meのメール登録開放ができるの。
無事申請が通ると良いなあ。
.
blogにコードを書く際に
イケてるメモ帳が欲しいなあとおもって探したよ。
.
Evernoteはターミナルの内容をコピペすると
背景の黒も一緒にコピーしてしまうの。
優秀なんだけれどもwordpressにコピペするときにジャマなので
純粋にテキストのみで書けるメモ帳がないか
お勧めを片っ端から試しました。
Google keepのメモ帳がシンプルで
クラウド対応しているの。
PCから入力後すぐにスマホに反映されるのも良い。
ダークテーマ
良いじゃんとおもって使っていたら
Evernoteがコードブロック可能なことを知った。
.
バッククオートでコードブロックしてあげれば
背景の黒も取れて全て解決することに気づいてしまった。
.
メモ帳難民した1日でしたあ。</description>
    </item>
    
    <item>
      <title>PORTもくもくメンテナンス</title>
      <link>https://hugo.suwa3.me/post/2019-07-20-616/</link>
      <pubDate>Sat, 20 Jul 2019 13:00:56 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-20-616/</guid>
      <description>PORTのもくもく会へ行ってきました。
おやつタイムに配られたシュークリームアイス😊
ランチタイムも色々と会話できたの楽しかったです。
主にMastodonのバックアップ/メンテナンスやりました。
.
やったこと
- postgreSQLのバックアップ
- GitHubで設定ファイルの保全
- EC2上へメンテナンスページの設置
- メンテナンスの流れ確認(設定ファイルについてなど)
.
postgreSQLのバックアップとったの。
.
第 23章バックアップとリストア
https://www.postgresql.jp/document/8.1/html/backup.html
復習しておこう。
Docker上にバックアップ用のディレクトリを作成して
pg_dumpを実行しました。
.
Nginx設定ファイル内の整理をして
Mastodonの設定ファイルとNginxの設定ファイルを
scpコマンドをつかいDLしてGitHubに保存。
.
EC2インスタンス上にメンテナンスページ用のディレクトリを作成して
GitHub上にメンテナンスページを置いていたので
それをgit cloneしてメンテナンスの準備をしたよ。
.
site-availableにメンテナンス用のNginx設定ファイルを置いて
中の設定ファイルをメンテナンス用に変更したの。
シンボリックリンクを書き換えて、設定ファイルをテストし
忘れずにNginxをリロード。
.
これblog書いていて
下書き保存がうまくいかず
一度ぜんぶ消えてしまったので
もう一度はじめから書き直したの
復習バッチリです！！！
.
帰りは一杯飲んで帰ったよお。</description>
    </item>
    
    <item>
      <title>Maintenance</title>
      <link>https://hugo.suwa3.me/post/2019-07-08-maintenance/</link>
      <pubDate>Mon, 08 Jul 2019 13:00:26 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-08-maintenance/</guid>
      <description>メンテナンスページつくったの。
適当なサイトの例をコピペして
色とか文とかいじってみた。
Hpをつくっていて
構造ガン無視し過ぎてfooterが一番上にきてしまっている図です。
動画のチュートリアルを粛々と観ていたのだけれども
｢自分のつくりたいようにつくりたーい｣
って自分でデザインしたらこのザマです。
最終的な解決法
footer要素も全て突っ込む。
GitHubのほうは明日反映させる〜</description>
    </item>
    
    <item>
      <title>Docker ネットワーク</title>
      <link>https://hugo.suwa3.me/post/2019-07-07-docker-%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF/</link>
      <pubDate>Sun, 07 Jul 2019 13:00:34 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-07-07-docker-%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF/</guid>
      <description>マストドン構築における
Dockerのネットワークについて、書いてまとめた。
言葉だけだと理解しがたいね。
結局、本の方も読んでみたのだけれども
今の時点でおそらくネットワークの細かなところまで知識必要ないなと判断して
マストドン構築のうえで必要最低限なものだけ覚えようとおもいました。
.
issueのひとつに｢バックアップをとる｣があったので
それを片付けたの。
まだ途中なので明日がんばる。
.
マイグレーション失敗しても
｢でもバックアップあるから大丈夫！｣
って言えたら、100てへぺろが
10てへぺろくらいで済むもんね。</description>
    </item>
    
    <item>
      <title>Knzk.me</title>
      <link>https://hugo.suwa3.me/post/2019-06-30-knzk-me/</link>
      <pubDate>Sun, 30 Jun 2019 13:00:25 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-30-knzk-me/</guid>
      <description>あしゅふぃさんの
マストドンセキュリティガイドライン
を参考に、セキュリティチェックをしました。
.
HSTSの設定
HTTPヘッダでnginxのバージョン情報を隠す設定
ポートスキャン
料金監視
ここらへんやった。
メールについては個人鯖なので、今の時点では設定不要かなあという判断でskipしました。
.
今後の最優先事項はdon.suwa3.meの保守です。
.
鯖立て楽しかったので色んな環境でもう10回くらい立ててみたい。
Web制作やIllustratorは今後も気分転換として進めたい。
WordPressは扱い方すこし慣れてきたので、書籍で勉強したいなあ。
クライアントアプリ作りは、動画で流れ把握しつつ簡単なものからステップアップして
週末のプログラミング勉強会にて、優先的にアプリ制作系のもの参加していきたいです。
.
.
今日でknzk.me最終日なので
お引越しも何とか間に合ったよ。
.
knzk.me閉鎖をきっかけに
自鯖を立てようとおもいたって
それが自分の人生の方向性を大きくかえたなあとおもうの
さびしいけれども、頑張りたいです。
.
しんみりしちゃうのニガテだから
明るいトゥートしたいなあ
なんておもうけれども、やっぱり寂しいの。
.
ローカルに沢山トゥート流れているのみるだけでうれしい。
好きだなあっておもいました。</description>
    </item>
    
    <item>
      <title>流れ</title>
      <link>https://hugo.suwa3.me/post/2019-06-29-%E6%B5%81%E3%82%8C/</link>
      <pubDate>Sat, 29 Jun 2019 13:00:36 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-29-%E6%B5%81%E3%82%8C/</guid>
      <description>5/31 knzk.me閉鎖と知る、1日落ち込む
6/1 自鯖をたてると決意する。三十路さんにホスティングサービスについて聞く
6/3 ドメイン購入、ホスティングサービスの選定
6/4 m.toで鯖立て
6/5 m.toで自鯖にログイン
6/6 ホスティングサービスですんなりいけたので、自分で構築しようと調べ出す
6/7 vimの使い方を調べる
6/10 ローカル開発環境の構築やDocker、UNIXコマンドなど必要そうな知識をpick upする
6/11 Linuxとは何か、UNIXコマンドについて調べる
6/12 UNIXコマンドに慣れるため練習する
6/14 証明書につまずくが、なんとかローカルにマストドンがたつ。ターミナルの背景を黒くしてフォントも変えて気分があがる
6/15 ローカルにたてたマストドンにAdminユーザーとしてログイン。管理画面にちょっと感動
6/16 Misskeyに興味をもつ。ライ塩さんのblogめちゃ読む
6/17 AWSに登録する。プログラミング系の学習動画サイトに片っ端から登録する
6/18 AWSでEC2インスタンスをたてる。Dockerコマンドについて調べる
6/19 AWSでwordpressのWebページを立ち上げる。gitとGitHubはメールとGmailの関係だと知る
6/20 Misskeyとマストドンのレシピを書いて並べてみる
6/21 DNS(Route53)でドメイン設定する。sudoについて調べる
6/22 Misskey構築するがファイルの設定につまり最後の90％で止まる。初めてプログラミングの勉強会に参加する
6/23 Misskeyをローカルにたてることに成功。上級者向けのためMisskeyの運用は諦める。マストドンに慣れてからMisskeyに挑戦してみようと決意する
6/24 疲れたので1日休む
6/25 マストドンたちあげる。Misskeyの構築でだいたいの骨組みは完成していたため移植する。メールサーバーについて調べる。PCについて知るため、ラズパイが欲しくなる
6/26 メールサーバーの設定できた。メディアストレージの設定につまる
6/27 メディアストレージの設定できた。errorがでると人に聞いていたが、少しずつ自分で解決策を探せることも増えた
6/28 Webページ制作で気分転換する
6/29 セキュリティチェック</description>
    </item>
    
    <item>
      <title>Dockerマスターになりたい</title>
      <link>https://hugo.suwa3.me/post/2019-06-27-docker%E3%83%9E%E3%82%B9%E3%82%BF%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8A%E3%81%9F%E3%81%84/</link>
      <pubDate>Thu, 27 Jun 2019 13:00:08 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-27-docker%E3%83%9E%E3%82%B9%E3%82%BF%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8A%E3%81%9F%E3%81%84/</guid>
      <description>最初はAWS日本語だしAWSの設定なら楽チン！
とおもっていたけれども、これ日本語が意味不明だと突然
｢何言ってるのかな？？｣
に、なるのつらい。
vimで設定ファイル編集するほうが
言われたとおり素直にコピペするだけなので
ラクだなと思うようになってきた。
素直にコピペして動く場合であれば。
.
パブリックアクセスのブロックは全解除でいけました。
公開しても良い画像で、ファイルをひとつ作ってみて
それを投稿してerror出ないかテストしてみました。
.
パケットポリシーエディタの中身は
AWSのポリシージェネレーターでパパッと生成できた。
しかしジェネレーターの選択欄ものすごく種類あるので
どれ選択したら良いのか初見わからないのでは…
.
で、メディアストレージの設定ファイルの編集なんですが
参考にしていたblogの内容の表記っていうのかな
若干違っていて
どれが正しいのかわからないので
設定ファイルを書き直して
Docker立ち上げ直して
マストドンで画像投稿してみて
Dockerのログみてerror探して
というのを10回ほど繰り返し
まだerror出ています。
うお〜〜〜〜〜〜
アプリ開発の動画みて気分転換しよ🙋
また明日がんばります。
.
でもねでもね
最初の頃はerrorの特定も全くわからなかったの。
最近は、だんだん流れがわかってきたの嬉しい。
こういうリズムで、こういう順序で
こういう角度からerrorの原因を潰していくのかあ
って、少しずつ見えてきた。
メディアストレージのerrorちっともわからんけども‪ᐠ( ᐛ )ᐟ笑
まじでわからん</description>
    </item>
    
    <item>
      <title>表参道の上島珈琲店</title>
      <link>https://hugo.suwa3.me/post/2019-06-26-501/</link>
      <pubDate>Wed, 26 Jun 2019 13:00:51 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-26-501/</guid>
      <description>朝から低気圧で体調不良でした。
強く打った歯がグラグラしていて
打撲痛なんだけれども、いててだったよ。
痛み止め飲みすぎて効かなくなっているのがつらい。
.
表参道の上島珈琲店とても良かった。
明る過ぎず、暗過ぎずの照明で目が疲れない。
WiFiちゃんと繋がる。
内装がオシャレで尚且つ落ち着く。
ソファ椅子が固くない。
素晴らしいね。
.
メールサーバーの設定をしていました。
SESってSimple email serviceの略なんだけど
どこがSimpleなんだ？ってかんじです。
.
躓いていた原因は
登録完了メールのアドレスをGmailで設定していて
登録するメールはYahooアドレスを使っていたの。
SESのEmail address欄でGmailのアドレスのみ登録していて
Yahooアドレスも登録いるんだなあと後から気づいた。
.
本来なら送信制限の解除をして、不特定多数からのメール送信許可をするから
そんな個別設定は不要なんだけれども
おひとり様だし、何かしら穴があっても嫌なので
今の時点でやらなくても良いリスキーな設定は避けてきたのね。
で結局つまずいて、GmailもYahooも両方登録して事なきを得ました。
設定ファイルの編集はスムーズにできた。
.
メディアストレージについては、パブリックアクセス許可の管理でつまずいています。
まず日本語がわからん。
元々英語なものがChromeの自動翻訳でわけわからん
って事が多々ある。
日本語の解読からです。
｢新しいアクセスコントロールリスト(ACL)を介して許可されたパケットとオブジェクトへのパブリックアクセスをブロックする｣
その下に
｢任意のアクセスコントロールリスト(ACL)を介して許可されたパケットとオブジェクトへのパブリックアクセスをブロックする｣
って続いてて、似たような文面であと2つ続いて
チェックボックスがついているんだけど
｢は？｣
ってなって全くもって意味不明なのでググります。
.
夜はメンタルよわよわだった。
体調不良と低気圧でダメだったねえ。
.
夢中になってやっていて
あまり勉強しているって感覚はなくて
ただひたすら楽しいので知りたいやりたい！
ってきもちなの。
あまり頑張ったり努力したりしている感覚はなくて苦しくない。
.
しかし、楽しいと余計に自分の体力を無視してやり続けてしまうところがあるので
体調には気をつけたいと思いました。
意識して休みます。</description>
    </item>
    
    <item>
      <title>鯖缶記念日</title>
      <link>https://hugo.suwa3.me/post/2019-06-25-495/</link>
      <pubDate>Tue, 25 Jun 2019 13:00:53 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-25-495/</guid>
      <description>設定が諸々残っていますが
なんとか鯖立て成功しました。
.
メールサーバーとメディアストレージを
なんとかしなきゃなの。
まず、どこのものを使おうか悩んで
猿毛さんからSend Gridを教えてもらったり
Mail gunってサービス名も
マストドンの設定で使っている鯖多いよーだとか
なんとなく聞いていたりしたので
比較や登録、チュートリアル検索して調べた。
.
おそらく無料系サービスは、無料枠をこえると
こえた時点で一度ストッパーが働いてしまうみたいで
おひとり様なら全然良いのだけれども
ひとが増えた際にパスワード変更が出来ないだとかの
不具合がおこる可能性を考えると
AWSのSESで自動的にスケールアップしてくれる方が良いのかなあ
とおもったり。
.
機能面だけなら、門戸を開くときや必要に迫られたタイミングでSESへ設定し直せば良いじゃない？
って話になるのだけれども
自分の勉強のためにあえてAWSを選択したので
(オーバースペックでは？と言われる)
おひとり様で気楽なときに無料枠内でSESに慣れることができるのは、それならそれで良いかなあとおもうの。
多少の授業料なら全然払います！ってきもち。
.
そしてメールサーバーの設定をしたのですが、メール来ないので明日なんとかします。
まとめて、整理して、切り分け作業だよ。
お昼休みに少し触って無理そうならメディアストレージの設定進めとこ。
これも良さそうなチュートリアルが見つかればAWSのS3で進めるとおもいます。
.
あと全然話が変わるんだけれども、ラズパイ欲しい。
うちにデスクトップのWindowsが2台あって
まあまあ年季の入ってるものと
それ以上に年季の入っているものの2台なので
MacBookを買ってからは、なかなか使わなくなってしまった。
.
しかしOSがWindowsだと開発するにしてもあまり使い道がなさそうなのがネック
むしろ物理サーバーにしてしまえば？
って案も出ているけれども、住んでいる地域バレが少し怖いかも。
単純に目的が
｢パソコンの中身や仕組みもっと知りたい！｣
なので、せっかくなら楽しいおもちゃにしたいなあってきもちで
ラズパイの使い道アイディアゆるぼです。</description>
    </item>
    
    <item>
      <title>Misskeyローカル構築成功</title>
      <link>https://hugo.suwa3.me/post/2019-06-23-489/</link>
      <pubDate>Sun, 23 Jun 2019 13:00:44 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-23-489/</guid>
      <description>Misskeyをローカルでたてることに成功しました。
溺れながらMisskey構築や運用をがんばるよりも
まずはMastodonで慣れてから
またMisskeyに挑戦してみたいなあとおもったよ。
何かしら問題が起こったときに
おそらく、うまく助けを求められないので
うごかない！停止！
を、繰り返してしまうとおもう。
マストドンで鯖立て頑張ろう。
.
色々と勉強になった。
.
次にやりたいことはクライアントアプリづくりです。
まずは動画で開発環境づくりを学んだあと
簡単につくれそうなアプリから少しずつステップアップしつつ
アプリ制作等、目的が明確な勉強会にも参加していきたい。
勉強会とても良いと思う。
ひとりだと本当にエラーや詰みの嵐なので
誰かしら聞ける相手がいるかいないかで
雲泥の差だなあとおもうの。
.
日曜日の夜は
焼肉を食べに行きました。
お酒も少し飲みました。
.
週末、頑張り過ぎてしまったのか
帰宅して、気持ちがぎゅーってなって
なぜか泣いてしまった。
理由がわからないの。
色々と
｢なぜ泣いたのか？｣
って、理由を考えてみたんだけれども
どれもそれらしい気もするし、違う気もするのね。
ゆっくり休もうかな。</description>
    </item>
    
    <item>
      <title>勉強会</title>
      <link>https://hugo.suwa3.me/post/2019-06-22-%E5%8B%89%E5%BC%B7%E4%BC%9A/</link>
      <pubDate>Sat, 22 Jun 2019 13:00:06 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-22-%E5%8B%89%E5%BC%B7%E4%BC%9A/</guid>
      <description>PORT勉強会に行ってきました。
ノージャンルもくもく会といったかんじ。
人数も多くて会場も綺麗でLT(発表)もあるし
アクセスも良くて月イチで開催しているの。
とても良い感じだったので継続して参加していきたいです。
.
Mastodonの構築
調べて、レシピをつくって
主にローカル汚すだとか
セキュリティ面でとんでもないレシピになっていないか
わかりそうなひとにチェックをして貰ってから
動くかどうかはコンピューターで答え合わせをする
みたいな感じで、マストドンのほうはわりとゆるゆる出来ていたの。
.
Misskeyマジでそんな余裕ないくらい
まず出回っている情報が少ないので
情報収集がままならず
AWS利用での構築方法を模索しなくてはならなくて
OSが違うだけで、こんなにも大変なのかとおもいました。
構築方法には書かれていないけれども
インストールしなくてはいけないものだとか
ファイルの設定内容についても
どこをどう編集したら良いかわからず。
とりあえず流れをgistにまとめました。
https://gist.github.com/suwa3/e2a4ea4d5558b6995cf2f0affaa9447e
でもこれ90％で動いてないの。
残り10％を調べなければいけないの。
.
夜からはみそぴぴデートだよ。
最近どうよ、
から始まって
近況報告しつつも
やっぱりMisskeyの構築のこと色々と聞いてもらった。
なんだかねえ、うまくいかないのよ。
みそぴぴもAWS使っているので
これから一緒に勉強していけたらいいなあ。
一緒に勉強できる仲間ほしいね。</description>
    </item>
    
    <item>
      <title>DNS</title>
      <link>https://hugo.suwa3.me/post/2019-06-21-dns/</link>
      <pubDate>Fri, 21 Jun 2019 13:00:12 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-21-dns/</guid>
      <description>DNS(Route53)でドメインの設定をしました。
OSがAmazon Linuxなので
Linux同様root権限でnode.jsやpostgreSQLをインストールするのかしら
とおもい、suやsudoについて調べていたけれども
EC2へのインストールはパッケージマネージャをつかうのね。
とりあえずググって明日やろうになりました。
.
お昼過ぎからバタバタしてしまった。
EXCELSIOR CAFEでサンドイッチぱぱっと食べてお昼済ました。
.
Misskeyについて情報を得られるかしら
とおもって、めいめいさんをフォロしました。
口調がうつりそうだなとおもいました。
.
夜はキャスを聴いたよ。
行動を制限されたり束縛されたりするのがとても嫌で
多少は我慢できるけれども
親から押さえつけられるのですら
10代の頃なんかは、ひたすら反発し続けてきたのに
他人からそれをやられて反発しないワケがないのよね。
ああ、日頃の行いかもしれない。</description>
    </item>
    
    <item>
      <title>レシピづくり</title>
      <link>https://hugo.suwa3.me/post/2019-06-20-%E3%83%AC%E3%82%B7%E3%83%94%E3%81%A5%E3%81%8F%E3%82%8A/</link>
      <pubDate>Thu, 20 Jun 2019 13:00:39 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-20-%E3%83%AC%E3%82%B7%E3%83%94%E3%81%A5%E3%81%8F%E3%82%8A/</guid>
      <description>AWSにおけるwordpressのチュートリアル読んでいるけれども
ステップ2で
Linux 仮想マシンの起動のステップ 2 d.～2 f. とステップ 3 を参照
って書いてあるの
おそらく参照するのはステップ 3 d.〜3 f.とステップ4のことだし
（そもそも仮想マシン起動のステップ2にfは存在しない）
その上wordpressチュートリアルのステップ3
システムlogにおいて
ssh設定再度試して探してもユーザーpassでてこないの
RDSでデータベースの設定を先にしておかないとダメなんか？
DBの設定について何も言及ないけれども実は必要なのか？
どちらにせよチュートリアルううううてかんじです。
.
謎は深まるけれども、いったんWeb上にwordpressたてられたので
ひとまず部屋のすみに置いておいて
本来の目的を見失いそうになってしまう。
wordpressはAWSに慣れるための練習で
目的はMisskeyの構築です。
.
今日の隙間時間はMisskeyのレシピづくりをすることに決定しました。
.
MastodonをAWSとDocker利用でたてるレシピと
MisskeyのReadMeを横に並べてみて
どこがどこの代替なのか
Mastodonとの違いは何なのかをきちんと整理したいとおもいます。
ふわっとだけど書いてみたの。
答え合わせがこわいけど楽しみだにゃ( •ω•ฅ)
Dockerわからんちなので後乗せクジラするかもしれない。
.
そしていつのまにかKnzkLiveの配信権限が付与されていた。
やったねえ
作業キャスもできちゃう。
8割うまくいかないひとなので
舌打ちしかしなさそう。
ツイキャスよりも気軽に配信できて
勝手に延長されていくの良さげ。
週末にでもKnzkLive試してみたいなあ。</description>
    </item>
    
    <item>
      <title>愛のポテト</title>
      <link>https://hugo.suwa3.me/post/2019-06-15-%E6%84%9B%E3%81%AE%E3%83%9D%E3%83%86%E3%83%88/</link>
      <pubDate>Sat, 15 Jun 2019 13:00:50 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-15-%E6%84%9B%E3%81%AE%E3%83%9D%E3%83%86%E3%83%88/</guid>
      <description>朝活でローカルにマストドンたてました。
Adminユーザーとしてログインしてみたよ。
管理画面みて
｢こんなかんじかあ！｣
ってなりました。
.
夕方からポケマス飲兵衛部だよ。
ナツキさんに愛のポテトを贈った。
3杯で眠くなるわ頭痛くなるわで
だいぶお酒弱いひとでした。
.
バーにチンザノやノイリーがなくて
逆に
｢フレンチベルモットならドランがありますよ｣
って案内されたんだけど
フレンチベルモットですらまあまあレアなのに
ドラン？！ってなったよ
ジンジャーエール辛口で割って飲みました。
美味しかったのでまた飲みたいです。
次は甘口で割って飲んでみたいなあ、
.
2軒目の後半ほぼ寝ていた気もする😢
なんか最近2軒目で既に眠いってこと増えた気がが
.
ケンカしないのが目標の飲み会でしたが
ちゃんと仲良く飲めたので良かったです。</description>
    </item>
    
    <item>
      <title>Hasklig</title>
      <link>https://hugo.suwa3.me/post/2019-06-14-hasklig/</link>
      <pubDate>Fri, 14 Jun 2019 13:00:33 +0000</pubDate>
      
      <guid>https://hugo.suwa3.me/post/2019-06-14-hasklig/</guid>
      <description>ローカルにマストドンたてるため奮闘しました。
証明書ほんとにわからん。
きちんと調べます。
.
鍵を生成→わかる
サーバー証明書を作成→わかる
Docker image→これをもとにホニャララしている(わからない)
Docker compose→なんか接続するのかしてるのか(わからない)
SQL→よく目にする(わからない)
.
とりあえずレシピ通りにやったら
何とかなったけれども
中身の理解が追いついていないパターンなので
基礎学習しつつ図にまとめる作業を続行します。
.
なんだかんだマストドンのローカルたてていたら
vimそこそこ使う羽目になって
簡単なコマンド覚えておいて良かったなとおもいました。
.
ターミナルのフォント設定いじっていたの。
ゼロの中に点があるフォント可愛いよなあとおもっていて
調べたらHaskligというらしく
探したらGitHubにソースあったので設定してみました。
Hasklig
可愛い。テンション上がる。
Atomの設定もついでに変えた。
.
あと、来週から勉強会デビューします。
connpassで検索して
都内で気軽に参加できそうな無料の勉強会に登録した。
発表はしません。
いつかそういった場で発表できるくらいには
きちんとやりたいなあ。
.
人見知りなので初めての場所、緊張する。</description>
    </item>
    
  </channel>
</rss>
